!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Bronze",[],e):"object"==typeof exports?exports.Bronze=e():t.Bronze=e()}(window,function(){return function(n){var i={};function o(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=n,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/dist",o(o.s=15)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}},function(n,t){function i(t,e){return n.exports=i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}n.exports=i},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}e.exports=n},function(t,e,n){t.exports=n(9)},function(t,e){function u(t,e,n,i,o,r,a){try{var s=t[r](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,o)}t.exports=function(s){return function(){var t=this,a=arguments;return new Promise(function(e,n){var i=s.apply(t,a);function o(t){u(i,e,n,o,r,"next",t)}function r(t){u(i,e,n,o,r,"throw",t)}o(void 0)})}}},function(t,e,n){var i=n(11),o=n(12);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?o(t):e}},function(t,e,n){var i=n(2);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}},function(e,t,n){var i=n(3),o=n(2),r=n(13),a=n(14);function s(t){var n="function"==typeof Map?new Map:void 0;return e.exports=s=function(t){if(null===t||!r(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return a(t,arguments,i(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o(e,t)},s(t)}e.exports=s},function(t,e,n){var i=function(){return this||"object"==typeof self&&self}()||Function("return this")(),o=i.regeneratorRuntime&&0<=Object.getOwnPropertyNames(i).indexOf("regeneratorRuntime"),r=o&&i.regeneratorRuntime;if(i.regeneratorRuntime=void 0,t.exports=n(10),o)i.regeneratorRuntime=r;else try{delete i.regeneratorRuntime}catch(t){i.regeneratorRuntime=void 0}},function(B,t){!function(t){"use strict";var u,e=Object.prototype,c=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",r=n.toStringTag||"@@toStringTag",a="object"==typeof B,s=t.regeneratorRuntime;if(s)a&&(B.exports=s);else{(s=t.regeneratorRuntime=a?B.exports:{}).wrap=w;var l="suspendedStart",f="suspendedYield",m="executing",v="completed",b={},h={};h[o]=function(){return this};var d=Object.getPrototypeOf,p=d&&d(d(P([])));p&&p!==e&&c.call(p,o)&&(h=p);var y=_.prototype=L.prototype=Object.create(h);g.prototype=y.constructor=_,_.constructor=g,_[r]=g.displayName="GeneratorFunction",s.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},s.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,r in t||(t[r]="GeneratorFunction")),t.prototype=Object.create(y),t},s.awrap=function(t){return{__await:t}},G(R.prototype),R.prototype[i]=function(){return this},s.AsyncIterator=R,s.async=function(t,e,n,i){var o=new R(w(t,e,n,i));return s.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},G(y),y[r]="Generator",y[o]=function(){return this},y.toString=function(){return"[object Generator]"},s.keys=function(n){var i=[];for(var t in n)i.push(t);return i.reverse(),function t(){for(;i.length;){var e=i.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},s.values=P,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function t(t,e){return r.type="throw",r.arg=n,i.next=t,e&&(i.method="next",i.arg=u),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],r=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=c.call(o,"catchLoc"),s=c.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&c.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=t,r.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),b}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var o=i.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=u),b}}}function w(t,e,n,i){var r,a,s,u,o=e&&e.prototype instanceof L?e:L,c=Object.create(o.prototype),h=new T(i||[]);return c._invoke=(r=t,a=n,s=h,u=l,function(t,e){if(u===m)throw new Error("Generator is already running");if(u===v){if("throw"===t)throw e;return F()}for(s.method=t,s.arg=e;;){var n=s.delegate;if(n){var i=E(n,s);if(i){if(i===b)continue;return i}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(u===l)throw u=v,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);u=m;var o=x(r,a,s);if("normal"===o.type){if(u=s.done?v:f,o.arg===b)continue;return{value:o.arg,done:s.done}}"throw"===o.type&&(u=v,s.method="throw",s.arg=o.arg)}}),c}function x(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function L(){}function g(){}function _(){}function G(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function R(u){var e;this._invoke=function(n,i){function t(){return new Promise(function(t,e){!function e(t,n,i,o){var r=x(u[t],u,n);if("throw"!==r.type){var a=r.arg,s=a.value;return s&&"object"==typeof s&&c.call(s,"__await")?Promise.resolve(s.__await).then(function(t){e("next",t,i,o)},function(t){e("throw",t,i,o)}):Promise.resolve(s).then(function(t){a.value=t,i(a)},function(t){return e("throw",t,i,o)})}o(r.arg)}(n,i,t,e)})}return e=e?e.then(t,t):t()}}function E(t,e){var n=t.iterator[e.method];if(n===u){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=u,E(t,e),"throw"===e.method))return b;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var i=x(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,b;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,b):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function P(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(c.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=u,t.done=!0,t};return i.next=i}}return{next:F}}function F(){return{value:u,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(e,t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=i=function(t){return n(t)}:e.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},i(t)}e.exports=i},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(i,t,e){var r=e(2);function o(t,e,n){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?i.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}:i.exports=o=Reflect.construct,o.apply(null,arguments)}i.exports=o},function(t,e,n){"use strict";function i(t){return 180*t/Math.PI}function a(t){return t*Math.PI/180}function o(t){return 0==(t&t-1)}n.r(e);var r=n(0),s=n.n(r),u=n(1),c=n.n(u),h=function(){function t(){return s()(this,t),this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this}return c()(t,[{key:"perspective",value:function(t,e,n,i,o){var r=Math.tan(.5*Math.PI-.5*t),a=1/(i-o);return this.matrix=[r/(e/n),0,0,0,0,r,0,0,0,0,(i+o)*a,-1,0,0,i*o*a*2,0],this}},{key:"multiply",value:function(t){var e=this.matrix[0],n=this.matrix[1],i=this.matrix[2],o=this.matrix[3],r=this.matrix[4],a=this.matrix[5],s=this.matrix[6],u=this.matrix[7],c=this.matrix[8],h=this.matrix[9],l=this.matrix[10],f=this.matrix[11],m=this.matrix[12],v=this.matrix[13],b=this.matrix[14],d=this.matrix[15],p=t[0],y=t[1],w=t[2],x=t[3],L=t[4],g=t[5],_=t[6],G=t[7],R=t[8],E=t[9],A=t[10],k=t[11],T=t[12],P=t[13],F=t[14],B=t[15];this.matrix=[p*e+y*r+w*c+x*m,p*n+y*a+w*h+x*v,p*i+y*s+w*l+x*b,p*o+y*u+w*f+x*d,L*e+g*r+_*c+G*m,L*n+g*a+_*h+G*v,L*i+g*s+_*l+G*b,L*o+g*u+_*f+G*d,R*e+E*r+A*c+k*m,R*n+E*a+A*h+k*v,R*i+E*s+A*l+k*b,R*o+E*u+A*f+k*d,T*e+P*r+F*c+B*m,T*n+P*a+F*h+B*v,T*i+P*s+F*l+B*b,T*o+P*u+F*f+B*d]}},{key:"multiply_",value:function(t){var e=this.matrix[0],n=this.matrix[1],i=this.matrix[2],o=this.matrix[3],r=this.matrix[4],a=this.matrix[5],s=this.matrix[6],u=this.matrix[7],c=this.matrix[8],h=this.matrix[9],l=this.matrix[10],f=this.matrix[11],m=this.matrix[12],v=this.matrix[13],b=this.matrix[14],d=this.matrix[15],p=t[0],y=t[1],w=t[2],x=t[3],L=t[4],g=t[5],_=t[6],G=t[7],R=t[8],E=t[9],A=t[10],k=t[11],T=t[12],P=t[13],F=t[14],B=t[15];return[p*e+y*r+w*c+x*m,p*n+y*a+w*h+x*v,p*i+y*s+w*l+x*b,p*o+y*u+w*f+x*d,L*e+g*r+_*c+G*m,L*n+g*a+_*h+G*v,L*i+g*s+_*l+G*b,L*o+g*u+_*f+G*d,R*e+E*r+A*c+k*m,R*n+E*a+A*h+k*v,R*i+E*s+A*l+k*b,R*o+E*u+A*f+k*d,T*e+P*r+F*c+B*m,T*n+P*a+F*h+B*v,T*i+P*s+F*l+B*b,T*o+P*u+F*f+B*d]}},{key:"translate",value:function(t,e,n){this.multiply(f(t,e,n))}},{key:"translate_",value:function(t,e,n){return this.multiply_(f(t,e,n))}},{key:"rotateX",value:function(t){this.multiply(y(t))}},{key:"rotateY",value:function(t){this.multiply(w(t))}},{key:"rotateZ",value:function(t){this.multiply(x(t))}},{key:"scale",value:function(t,e,n){this.multiply(m(t,e,n))}}]),t}();function l(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function f(t,e,n){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1]}function y(t){var e=Math.cos(t),n=Math.sin(t);return[1,0,0,0,0,e,n,0,0,-n,e,0,0,0,0,1]}function w(t){var e=Math.cos(t),n=Math.sin(t);return[e,0,-n,0,0,1,0,0,n,0,e,0,0,0,0,1]}function x(t){var e=Math.cos(t),n=Math.sin(t);return[e,n,0,0,-n,e,0,0,0,0,1,0,0,0,0,1]}function m(t,e,n){return[t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]}function L(t,e){var n=t[0],i=t[1],o=t[2],r=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=t[9],f=t[10],m=t[11],v=t[12],b=t[13],d=t[14],p=t[15],y=e[0],w=e[1],x=e[2],L=e[3],g=e[4],_=e[5],G=e[6],R=e[7],E=e[8],A=e[9],k=e[10],T=e[11],P=e[12],F=e[13],B=e[14],O=e[15];return[y*n+w*a+x*h+L*v,y*i+w*s+x*l+L*b,y*o+w*u+x*f+L*d,y*r+w*c+x*m+L*p,g*n+_*a+G*h+R*v,g*i+_*s+G*l+R*b,g*o+_*u+G*f+R*d,g*r+_*c+G*m+R*p,E*n+A*a+k*h+T*v,E*i+A*s+k*l+T*b,E*o+A*u+k*f+T*d,E*r+A*c+k*m+T*p,P*n+F*a+B*h+O*v,P*i+F*s+B*l+O*b,P*o+F*u+B*f+O*d,P*r+F*c+B*m+O*p]}function v(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3]]}function g(t,e){for(var n=new Float32Array(4),i=0;i<4;++i)for(var o=n[i]=0;o<4;++o)n[i]+=e[o]*t[4*o+i];return n}function _(t){var e=new Float32Array(16),n=t[0],i=t[1],o=t[2],r=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=t[9],f=t[10],m=t[11],v=t[12],b=t[13],d=t[14],p=t[15],y=f*p,w=d*m,x=u*p,L=d*c,g=u*m,_=f*c,G=o*p,R=d*r,E=o*m,A=f*r,k=o*c,T=u*r,P=h*b,F=v*l,B=a*b,O=v*s,C=a*l,j=h*s,U=n*b,S=v*i,M=n*l,D=h*i,I=n*s,N=a*i,Y=y*s+L*l+g*b-(w*s+x*l+_*b),H=w*i+G*l+A*b-(y*i+R*l+E*b),V=x*i+R*s+k*b-(L*i+G*s+T*b),X=_*i+E*s+T*l-(g*i+A*s+k*l),z=1/(n*Y+a*H+h*V+v*X);return e[0]=z*Y,e[1]=z*H,e[2]=z*V,e[3]=z*X,e[4]=z*(w*a+x*h+_*v-(y*a+L*h+g*v)),e[5]=z*(y*n+R*h+E*v-(w*n+G*h+A*v)),e[6]=z*(L*n+G*a+T*v-(x*n+R*a+k*v)),e[7]=z*(g*n+A*a+k*h-(_*n+E*a+T*h)),e[8]=z*(P*c+O*m+C*p-(F*c+B*m+j*p)),e[9]=z*(F*r+U*m+D*p-(P*r+S*m+M*p)),e[10]=z*(B*r+S*c+I*p-(O*r+U*c+N*p)),e[11]=z*(j*r+M*c+N*m-(C*r+D*c+I*m)),e[12]=z*(B*f+j*d+F*u-(C*d+P*u+O*f)),e[13]=z*(M*d+P*o+S*f-(U*f+D*d+F*o)),e[14]=z*(U*u+N*d+O*o-(I*d+B*o+S*u)),e[15]=z*(I*f+C*o+D*u-(M*u+N*f+j*o)),e}function b(t){var e=new Float32Array(3),n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return 1e-5<n&&(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n,e)}var d=n(4),p=n.n(d),G=n(5),R=n.n(G);function E(t,e,n){var i,o=t;if("fragment"==e)i=n.createShader(n.FRAGMENT_SHADER);else{if("vertex"!=e)return console.log("Wrong shader type"),null;i=n.createShader(n.VERTEX_SHADER)}if(n.shaderSource(i,o),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS))throw"Could not compile shader:"+n.getShaderInfoLog(i);return i}var A,k=n(6),T=n.n(k),P=n(3),F=n.n(P),B=n(7),O=n.n(B),C=n(8),j=function(t){function o(t,e,n){var i;return s()(this,o),(i=T()(this,F()(o).call(this))).src=t,null!=e&&null!=n&&(i.width=e,i.height=n),i.coords=[],i.addEventListener("load",function(){i.loaded=!0}),i.color=new Uint8Array([255,255,255,255]),i._textureBlockLocation=null,i}return O()(o,t),c()(o,[{key:"scale",value:function(t,e){this.width=width*t,this.height=height*e}},{key:"setCoords",value:function(t){this.coords=t}},{key:"setColorRGBA",value:function(t,e,n,i){this.color=new Uint8Array([t,e,n,i])}}]),o}(n.n(C)()(Image)),U=function(){function e(t){s()(this,e),t.objects.push(this),this.engine=t,this.webGL=t.webGL,this.camera=t.camera,this.texture=t.noTexture,this.position=[0,0,0],this.rotation=[0,0,0],this.scaling=[1,1,1],this.rotationPoint=[0,0,0],this.parentRotation=[0,0,0],this.relativeCameraPosition=null,this.faces=[],this.collisionBoxes=[],this.UIElement=!1}return c()(e,[{key:"setTexture",value:function(t){this.texture=t}},{key:"setPosition",value:function(t,e,n){this.position[0]=t,this.position[1]=e,this.position[2]=n}},{key:"move",value:function(t,e,n){this.position[0]+=t,this.position[1]+=e,this.position[2]+=n}},{key:"moveRelativeToTheCamera",value:function(t,e,n){var i=[t,e,n,1];i=v(this.camera.inventedMatrix,i),this.position[0]+=i[0],this.position[1]+=i[1],this.position[2]+=i[2]}},{key:"rotate",value:function(t,e,n){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=n}},{key:"setRotation",value:function(t,e,n){this.rotation[0]=t,this.rotation[1]=e,this.rotation[2]=n}},{key:"setRotationPoint",value:function(t,e,n){this.rotationPoint=[t,e,n]}},{key:"setParentRotation",value:function(t,e,n){this.parentRotation=[t,e,n]}},{key:"scale",value:function(t,e,n){this.scaling=[t,e,n]}},{key:"animation",value:function(){this.rotate(0,0,0)}},{key:"animate",value:function(t,e){e=e||this.animation,setInterval(e,1e3/t)}},{key:"destroy",value:function(){this.engine.splice(this.engine.objects.indexOf(this),1)}},{key:"compile",value:function(t){var l=this,f=[],m=[],v=[],e=t.split("\n"),s={x:[0,0],y:[0,0],z:[0,0]};e.forEach(function(t){for(var h=t.split(" "),e=h.length;e--;)""!=h[e]&&"\r"!=h[e]||h.splice(e,1);if("v"==h[0]){var n=parseFloat(h[1]),i=parseFloat(h[2]),o=parseFloat(h[3]);s.x[1]<n&&(s.x[1]=n),s.y[1]<i&&(s.y[1]=i),s.z[1]<o&&(s.z[1]=o),s.x[0]>n&&(s.x[0]=n),s.y[0]>i&&(s.y[0]=i),s.z[0]>o&&(s.z[0]=o),f.push([n,i,o])}else if("vn"==h[0])v.push([parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])]);else if("vt"==h[0])m.push([parseFloat(h[1]),parseFloat(h[2])]);else if("f"==h[0])for(var r=function(t){var e=h[t].split("/");if("\r"==e[length-1])return"break";for(var n=null,i=null,o=void 0,r=0;r<l.faces.length;r++){var a=l.faces[r];a.vertexesCount==h.length-1&&(n=a.vertexes,i=a.textureCoords,o=a.normals)}null==n&&(l.faces.push({vertexesCount:h.length-1,vertexes:[],textureCoords:[],normals:[]}),n=l.faces[l.faces.length-1].vertexes,i=l.faces[l.faces.length-1].textureCoords,o=l.faces[l.faces.length-1].normals);var s=parseFloat(e[0]);s<0&&(s=f.length+s+1);var u=parseFloat(e[1]);u<0&&(u=m.length+u+1);var c=parseFloat(e[2]);c<0&&(c=v.length+c+1),f[s-1].forEach(function(t){n.push(t)}),0<m.length&&m[u-1].forEach(function(t){i.push(t)}),null!=e[2]?v[c-1].forEach(function(t){o.push(t)}):o.push(0,0,0)},a=1;a<h.length;a++){if("break"===r(a))break}});for(var n=0;n<this.faces.length;n++){var i=this.faces[n];i.vertexesBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,i.vertexesBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(i.vertexes),this.webGL.STATIC_DRAW),i.coordsBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,i.coordsBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(i.textureCoords),this.webGL.STATIC_DRAW),i.normalBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,i.normalBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(i.normals),this.webGL.STATIC_DRAW)}this.collisionBoxes.push(s)}},{key:"loadFromObj",value:function(t){var e=this,n=new XMLHttpRequest;n.open("GET",t),n.onreadystatechange=function(){4==n.readyState&&e.compile(n.responseText)},n.send()}}]),e}(),S=function(){function e(t){s()(this,e),this.engine=t,this.objects=[],this.lands=[],this.camera}return c()(e,[{key:"createObject",value:function(){var t=new U(engine);return this.engine.objects.push(t),t}},{key:"addObject",value:function(t){this.objects.push(t)}},{key:"removeObject",value:function(t){var e=this.objects.indexOf(t);return-1!=e&&(this.objects.splice(e,1),!0)}},{key:"removeObjectByName",value:function(e){var n=this;return this.objects.forEach(function(t){if(t.name==e)return n.removeObject(t),!0}),!1}}]),e}(),M=function(){function i(t){var e,n;s()(this,i),this.webGL=(n=(e=t).getContext("experimental-webgl"),window.addEventListener("resize",function(){e.width=e.offsetWidth,e.height=e.offsetHeight}),n),this.canvas=t,this.width=t.width,this.height=t.height,this.polygons=[],this.objects=[],this.ui={objects:[]},this.textures=[],this.camera=null,this.debugger=null,this.controls=null,this.selectedObject=null,this._globalPositionBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._globalPositionBuffer),this._globalTextureBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._globalTextureBuffer),this._initShaders(),this.noTexture=new j,this.noTexture.setColorRGBA(219,58,52,255),this.bindTexture(this.noTexture),this._objectSelectHandler}var t;return c()(i,[{key:"_initShaders",value:function(){var t,e,n,i,o,r=E("attribute vec4 a_position;\r\nattribute vec2 a_texcoord;\r\nattribute vec4 a_normal;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mat4 u_objectRotation;\r\nuniform vec3 u_lightWorldPosition;\r\nuniform mat4 u_cameraMatrix;\r\n\r\nvarying vec2 v_texcoord;\r\nvarying vec3 v_normal;\r\nvarying vec3 v_surfaceToLight;\r\n\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * a_position;\r\n    \r\n    v_texcoord = a_texcoord;\r\n    v_normal = vec3(u_objectRotation * a_normal);\r\n\r\n    vec3 surfaceWorldPosition = (u_cameraMatrix * a_position).xyz;\r\n    \r\n    v_surfaceToLight = u_lightWorldPosition; // - surfaceWorldPosition;\r\n}","vertex",this.webGL),a=E("precision mediump float;\r\n\r\nvarying vec2 v_texcoord;\r\nvarying vec3 v_normal;\r\n\r\nuniform sampler2D u_texture;\r\nuniform vec3 u_reverseLightDirection;\r\nvarying vec3 v_surfaceToLight;\r\n\r\nvoid main() {\r\n    vec3 normal = normalize(v_normal);\r\n    // float light = dot(normal, u_reverseLightDirection);\r\n    vec3 surfaceToLightDirection = normalize(v_surfaceToLight);\r\n    float light = dot(v_normal, surfaceToLightDirection);\r\n    if (light < 0.5)\r\n        light = 0.5;\r\n    \r\n    gl_FragColor = texture2D(u_texture, v_texcoord);\r\n    gl_FragColor.rgb *= (light);\r\n    if(gl_FragColor.a < 0.2)\r\n        discard;\r\n}","fragment",this.webGL);this.shaderProgram=(t=this.webGL,e=r,n=a,i=!1,o=t.createProgram(),t.attachShader(o,e),t.attachShader(o,n),t.linkProgram(o),t.useProgram(o),i&&(t.deleteShader(e),t.deleteShader(n)),o),this.positionLocation=this.webGL.getAttribLocation(this.shaderProgram,"a_position"),this.textureCoordinatesLocation=this.webGL.getAttribLocation(this.shaderProgram,"a_texcoord"),this.textureLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_texture"),this.matrixLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_matrix"),this.objectRotationLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_objectRotation"),this.normalLocation=this.webGL.getAttribLocation(this.shaderProgram,"a_normal"),this.reverseLightDirectionLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_reverseLightDirection"),this.lightWorldPositionLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_lightWorldPosition"),this.cameraLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_cameraMatrix"),this.webGL.useProgram(this.shaderProgram),this.webGL.viewport(0,0,this.width,this.height),this.webGL.enable(this.webGL.CULL_FACE),this.webGL.enable(this.webGL.DEPTH_TEST)}},{key:"setCamera",value:function(t){this.camera=t}},{key:"canvasResized",value:function(){this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.webGL.viewport(0,0,this.width,this.height)}},{key:"onObjectSelect",value:function(t){this._objectSelectHandler=t}},{key:"bindTexture",value:function(t){var e=this;t._textureBlockLocation=this.textures.length,this.textures.push(t),t._WebGLtexture=this.webGL.createTexture(),this.webGL.activeTexture(this.webGL.TEXTURE0+t._textureBlockLocation),this.webGL.bindTexture(this.webGL.TEXTURE_2D,t._WebGLtexture),t.loaded?(this.webGL.texImage2D(this.webGL.TEXTURE_2D,0,this.webGL.RGBA,this.webGL.RGBA,this.webGL.UNSIGNED_BYTE,t),this.webGL.generateMipmap(this.webGL.TEXTURE_2D),o(image.width)&&o(image.height)?this.webGL.generateMipmap(this.webGL.TEXTURE_2D):(this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_WRAP_S,this.webGL.CLAMP_TO_EDGE),this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_WRAP_T,this.webGL.CLAMP_TO_EDGE),this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_MIN_FILTER,this.webGL.LINEAR))):(this.webGL.texImage2D(this.webGL.TEXTURE_2D,0,this.webGL.RGBA,1,1,0,this.webGL.RGBA,this.webGL.UNSIGNED_BYTE,t.color),t.addEventListener("load",function(){e.webGL.activeTexture(e.webGL.TEXTURE0+t._textureBlockLocation),e.webGL.texImage2D(e.webGL.TEXTURE_2D,0,e.webGL.RGBA,e.webGL.RGBA,e.webGL.UNSIGNED_BYTE,t),o(t.width)&&o(t.height)?e.webGL.generateMipmap(e.webGL.TEXTURE_2D):(e.webGL.texParameteri(e.webGL.TEXTURE_2D,e.webGL.TEXTURE_WRAP_S,e.webGL.CLAMP_TO_EDGE),e.webGL.texParameteri(e.webGL.TEXTURE_2D,e.webGL.TEXTURE_WRAP_T,e.webGL.CLAMP_TO_EDGE),e.webGL.texParameteri(e.webGL.TEXTURE_2D,e.webGL.TEXTURE_MIN_FILTER,e.webGL.LINEAR))}))}},{key:"_update",value:function(){var b,e,n,i,d=this;null!=this.camera._controlFunction&&(this.camera._controlFunction(),this.controls.mouse.movement.x=0,this.controls.mouse.movement.y=0),this.selectedObject=null,this.polygons.forEach(function(t){(b=new h).perspective(d.camera.fieldOfViewRad,d.width,d.height,1,2e4),b.multiply(d.camera.inventedMatrix),(i=new h).multiply(_(f(t.rotationPoint[0],t.rotationPoint[1],t.rotationPoint[2]))),i.translate(t.position[0],t.position[1],t.position[2]),e=L(e=L(y(t.rotation[0]),w(t.rotation[1])),x(t.rotation[2])),null!=t.parentRotation&&(n=L(n=L(y(t.parentRotation[0]),w(t.parentRotation[1])),x(t.parentRotation[2])),t._world=n,e=L(n,e)),i.multiply(e),i.translate(t.rotationPoint[0],t.rotationPoint[1],t.rotationPoint[2]),i.scale(1,1,1),b.multiply(i.matrix),t._matrix=b.matrix,t._rotationMatrix=e});var p=null;this.objects.forEach(function(m){if((b=new h).perspective(d.camera.fieldOfViewRad,d.width,d.height,1,2e4),m.UIElement||b.multiply(d.camera.inventedMatrix),(i=new h).multiply(_(f(m.rotationPoint[0],m.rotationPoint[1],m.rotationPoint[2]))),i.translate(m.position[0],m.position[1],m.position[2]),e=L(e=L(y(m.rotation[0]),w(m.rotation[1])),x(m.rotation[2])),n=L(n=L(y(m.parentRotation[0]),w(m.parentRotation[1])),x(m.parentRotation[2])),m._world=n,e=L(n,e),i.multiply(e),i.translate(m.rotationPoint[0],m.rotationPoint[1],m.rotationPoint[2]),i.scale(m.scaling[0],m.scaling[1],m.scaling[2]),b.multiply(i.matrix),!m.UIElement){var v=!1;m.collisionBoxes.forEach(function(t){for(var e=[],n=0;n<t.x.length;n++)for(var i=t.x[n],o=0;o<t.y.length;o++)for(var r=t.y[o],a=0;a<t.z.length;a++){var s=t.z[a],u=g(b.matrix,[i,r,s,1]);u[0]=u[0]/u[3],u[1]=u[1]/u[3],u[0]=(.5*u[0]+.5)*d.width,u[1]=(-.5*u[1]+.5)*d.height,u[0]=u[0]<0?0:u[0],u[1]=u[1]<0?0:u[1],u[0]=u[0]>d.width?d.width:u[0],u[1]=u[1]>d.height?d.height:u[1],0<=u[2]&&e.push(u)}for(var c=[1e4,1e4,-1e3],h=[-1e4,-1e4],l=0;l<e.length;l++){var f=e[l];f[0]<c[0]?c[0]=f[0]:f[0]>h[0]&&(h[0]=f[0]),f[1]<c[1]?c[1]=f[1]:f[1]>h[1]&&(h[1]=f[1]),f[2]>c[2]&&(c[2]=f[2])}m.relativeCameraPosition={x:{left:c[0],right:h[0]},y:{top:h[1],bottom:c[1]},depth:c[2]},d.controls.mouse.x>c[0]&&d.controls.mouse.x<h[0]&&d.controls.mouse.y>c[1]&&d.controls.mouse.y<h[1]&&(v=!0);d.controls.mouse;v&&(null==p&&(p=m),p.relativeCameraPosition.depth>=c[2]&&(p=m))})}d.selectedObject=p,m.UIElement||d.selectedObject||null==d._objectSelectHandler||d._objectSelectHandler(p),m._matrix=b.matrix,m._rotationMatrix=e})}},{key:"_draw",value:function(){var n=this;this.webGL.clear(this.webGL.COLOR_BUFFER_BIT|this.webGL.DEPTH_BUFFER_BIT),this.webGL.uniform3fv(this.reverseLightDirectionLocation,b([-.1,.5,1])),this.webGL.uniform3fv(this.lightWorldPositionLocation,[0,100,400]),this.webGL.uniformMatrix4fv(this.cameraLocation,!1,this.camera.matrix),this.polygons.forEach(function(t){n.webGL.enableVertexAttribArray(n.positionLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t._vertexesBuffer),n.webGL.vertexAttribPointer(n.positionLocation,3,n.webGL.FLOAT,!1,0,0),n.webGL.enableVertexAttribArray(n.textureCoordinatesLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t._coordsBuffer),n.webGL.vertexAttribPointer(n.textureCoordinatesLocation,2,n.webGL.FLOAT,!1,0,0),n.webGL.enableVertexAttribArray(n.normalLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t._normalBuffer),n.webGL.vertexAttribPointer(n.normalLocation,3,n.webGL.FLOAT,!1,0,0),n.webGL.uniform1i(n.textureLocation,t.texture._textureBlockLocation),n.webGL.uniformMatrix4fv(n.matrixLocation,!1,t._matrix),n.webGL.uniformMatrix4fv(n.objectRotationLocation,!1,t._world),n.webGL.drawArrays(n.webGL.TRIANGLES,0,3)}),this.objects.forEach(function(e){e.faces.forEach(function(t){n.webGL.enableVertexAttribArray(n.positionLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t.vertexesBuffer),n.webGL.vertexAttribPointer(n.positionLocation,3,n.webGL.FLOAT,!1,0,0),n.webGL.enableVertexAttribArray(n.textureCoordinatesLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t.coordsBuffer),n.webGL.vertexAttribPointer(n.textureCoordinatesLocation,2,n.webGL.FLOAT,!1,0,0),n.webGL.enableVertexAttribArray(n.normalLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t.normalBuffer),n.webGL.vertexAttribPointer(n.normalLocation,3,n.webGL.FLOAT,!1,0,0),n.webGL.uniform1i(n.textureLocation,e.texture._textureBlockLocation),n.webGL.uniformMatrix4fv(n.matrixLocation,!1,e._matrix),n.webGL.uniformMatrix4fv(n.objectRotationLocation,!1,e._world),n.webGL.drawArrays(n.webGL.TRIANGLES,0,t.vertexes.length/t.vertexesCount)}),n.webGL.enable(n.webGL.DEPTH_TEST)}),this.ui.objects.forEach(function(e){e.faces.forEach(function(t){n.webGL.enableVertexAttribArray(n.positionLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t.vertexesBuffer),n.webGL.vertexAttribPointer(n.positionLocation,3,n.webGL.FLOAT,!1,0,0),n.webGL.enableVertexAttribArray(n.textureCoordinatesLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t.coordsBuffer),n.webGL.vertexAttribPointer(n.textureCoordinatesLocation,2,n.webGL.FLOAT,!1,0,0),n.webGL.enableVertexAttribArray(n.normalLocation),n.webGL.bindBuffer(n.webGL.ARRAY_BUFFER,t.normalBuffer),n.webGL.vertexAttribPointer(n.normalLocation,3,n.webGL.FLOAT,!1,0,0),n.webGL.uniform1i(n.textureLocation,e.texture._textureBlockLocation),n.webGL.uniformMatrix4fv(n.matrixLocation,!1,e._matrix),n.webGL.uniformMatrix4fv(n.objectRotationLocation,!1,e._world),n.webGL.drawArrays(n.webGL.TRIANGLES,0,t.vertexes.length/t.vertexesCount)})}),null!=this.debugger&&this.debugger.updateInfo()}},{key:"render",value:(t=R()(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._update();case 2:return t.next=4,this._draw();case 4:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"run",value:function(){A=this,console.log(),console.log("     %c%s","color: rgba(247, 137, 74, 1); text-align: center; font-size: 16px; font-weight: 700","Bronze Engine is running"),console.log(),console.info("     Version : 0.0.1"),console.info("     Docs    : http://m0ksem.design/Bronze-Engine/docs/global"),console.info("     GitHub  : https://github.com/m0ksem/Bronze-Engine"),console.log(),D()}}]),i}();function D(){requestAnimationFrame(D),A.render()}!function(){for(var r=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var n=(new Date).getTime(),i=Math.max(0,16-(n-r)),o=window.setTimeout(function(){t(n+i)},i);return r=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var I=function(){function t(){s()(this,t),this.position=[0,0,100],this.up=[0,1,0],this.target=[0,0,0],this.fieldOfView=90,this.fieldOfViewRad=a(90),this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.rotation=[0,0,0],this._collisions=!1,this._lookUpMatrix=null}return c()(t,[{key:"setFieldOfView",value:function(t){this.fieldOfView=t,this.fieldOfViewRad=a(t)}},{key:"setCollisions",value:function(t){this._collisions=t}},{key:"setPosition",value:function(t,e,n){this.position=[t,e,n],this.computeMatrix()}},{key:"move",value:function(t,e,n){this.position[0]+=t,this.position[1]+=e,this.position[2]+=n,this.computeMatrix()}},{key:"rotate",value:function(t,e,n){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=n,this.computeMatrix()}},{key:"setRotation",value:function(t,e,n){this.rotation=[t,e,n],this.computeMatrix()}},{key:"computeMatrix",value:function(){this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.matrix=L(this.matrix,f(this.position[0],this.position[1],this.position[2]));var t=new h;t.multiply(w(a(this.rotation[1]))),t.multiply(y(a(this.rotation[0]))),t.multiply(x(a(this.rotation[2]))),this.matrix=L(this.matrix,t.matrix),null!=this._lookUpMatrix&&(this.matrix=L(this.matrix,this.lookAt(camera._lookUpMatrix,[0,1,0]))),this.rotationMatrix=_(t.matrix),this.inventedMatrix=_(this.matrix)}},{key:"setControl",value:function(t){this._controlFunction=t}},{key:"setLookUp",value:function(t,e,n){this._lookUpMatrix=null!=t?[t,e,n]:null}},{key:"lookAt",value:function(t,e){if(null==t)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];var n=normalize(subVec3(this.position,t)),i=normalize(cross(e,n)),o=normalize(cross(n,i));return[i[0],i[1],i[2],0,o[0],o[1],o[2],0,n[0],n[1],n[2],0,this.position[0],this.position[1],this.position[2],1]}}]),t}(),N=function(){function e(o){var r=this;s()(this,e),(o.controls=this).engine=o,this.mouseOverCanvas=!1,this._lockPointer=!0,this.pointerLocked=!1,this._rebind=!0,this._globalRebind=!1,this.keys=[],this._handlers=[],this._focusHandlers=[],this._blurHandlers=[],this._focusOnlyIfClick=!0,this.isFocused=!1,this._mouseHandlers=[null,null,null,null,null,null],this.mouse={x:0,y:0,buttons:[!1,!1,!1],movement:{x:0,y:0},sensitivity:1};for(var t=0;t<255;t++)this.keys[t]=!1,this._handlers[t]=null;window.onkeydown=function(t){return r.isFocused?(r.keys[t.keyCode]=!0,null!=r._handlers[t.keyCode]&&r._handlers[t.keyCode](t),!r._rebind):!r._globalRebind||!r._rebind},window.onkeyup=function(t){return r.keys[t.keyCode]=!1,!r._rebind},o.canvas.setAttribute("tabindex","0");var a=null;o.canvas.addEventListener("mousemove",function(t){if(r.pointerLocked)r.mouse.movement.x=-t.movementX*r.mouse.sensitivity,r.mouse.movement.y=-t.movementY*r.mouse.sensitivity,r.mouse.x=r.engine.width/2,r.mouse.y=r.engine.height/2;else{var e=o.canvas.getBoundingClientRect(),n=t.clientX-e.left,i=t.clientY-e.top;r.mouse.x=n,r.mouse.y=i,null==a&&(a={x:n,y:i}),r.mouse.movement.x=(n-a.x)*r.mouse.sensitivity,r.mouse.movement.y=(i-a.y)*r.mouse.sensitivity,a.x=n,a.y=i}},!1),window.addEventListener("mousemove",function(t){var e=o.canvas.getBoundingClientRect(),n=t.clientX,i=t.clientY;n<e.right&&n>e.left&&i<e.bottom&&i>e.top?(r.mouseOverCanvas=!0,r._focusOnlyIfClick||r.isFocused||o.canvas.focus()):(r.mouseOverCanvas=!1,r._focusOnlyIfClick||o.canvas.blur())}),o.canvas.onclick=function(){r._focusOnlyIfClick&&!r.isFocused&&o.canvas.focus(),r._lockPointer&&o.canvas.requestPointerLock()},o.canvas.onmousedown=function(t){return r.mouse.buttons[t.button]=!0,null!=r._mouseHandlers[2+t.button]&&r._mouseHandlers[2+t.button](t),!1},o.canvas.onmouseup=function(t){return r.mouse.buttons[t.button]=!1},o.canvas.oncontextmenu=function(){return!1},o.canvas.onblur=function(){r.isFocused=!1;for(var t=0;t<r._focusHandlers.length;t++)r._blurHandlers[t]()},o.canvas.onfocus=function(){r.isFocused=!0;for(var t=0;t<r._focusHandlers.length;t++)r._focusHandlers[t]()},document.addEventListener("pointerlockchange",function(){document.pointerLockElement===o.canvas?r.pointerLocked=!0:r.pointerLocked=!1},!1)}return c()(e,[{key:"clickForFocus",value:function(t){t=t||!this._focusOnlyIfClick,this._focusOnlyIfClick=t}},{key:"setSensitivity",value:function(t){this.mouse.sensitivity=t}},{key:"rebindDefaultBrowserActions",value:function(t){t=t||!this._rebind,this._rebind=t}},{key:"globalRebind",value:function(t){t=t||!this._globalRebind,this._globalRebind=t}},{key:"addOnFocusHandler",value:function(t){this._focusHandlers.push(t)}},{key:"addOnBlurHandler",value:function(t){this._blurHandlers.push(t)}},{key:"onKeyDown",value:function(t,e){this._handlers[t]=e}},{key:"onMouseDown",value:function(t,e){this._mouseHandlers[2+t]=e}},{key:"onMouseMove",value:function(t){this.engine.canvas.addEventListener("mousemove",t,!1)}},{key:"onContextMenu",value:function(t){this.engine.canvas.oncontextmenu=t}},{key:"lockPointer",value:function(t){t=t||!this._lockPointer,this._lockPointer=t}}]),e}(),Y=function(){function e(t){s()(this,e),(t.debugger=this).logArray=[],this.element=null}return c()(e,[{key:"setElement",value:function(t){this.element=t}},{key:"addLog",value:function(t,e,n,i,o){o=o||this.defaultOutput,this.logArray.push({name:t,object:e,value:n,view:i,output:o}),this.addView(i)}},{key:"createLogView",value:function(){return document.createElement("p")}},{key:"defaultOutput",value:function(t){return null!=object?t.name+" : "+t.object[t.value]:"log.name"}},{key:"addView",value:function(t){this.element.appendChild(t)}},{key:"updateInfo",value:function(){this.logArray.forEach(function(t){t.view.innerText=t.output(t)})}}]),e}(),H=function(){function e(t){s()(this,e),t&&t.polygons.push(this),this.webGL=t.webGL,this.texture=null,this.vertexes=[],this.position=[0,0,0],this.rotation=[0,0,0],this.rotationPoint=[0,0,0],this.parentRotation=[0,0,0],this.normals=[0,1,0,0,1,0,0,1,0],this._vertexesBuffer=null}return c()(e,[{key:"setTexture",value:function(t){this.texture=t}},{key:"setTextureCoords",value:function(t){this.textureCoords=t,this._coordsBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._coordsBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(this.textureCoords),this.webGL.STATIC_DRAW)}},{key:"setVertexes",value:function(t){this.vertexes=t,this._vertexesBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._vertexesBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(this.vertexes),this.webGL.STATIC_DRAW)}},{key:"setPosition",value:function(t,e,n){this.position[0]=t,this.position[1]=e,this.position[2]=n}},{key:"rotate",value:function(t,e,n){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=n}},{key:"setRotation",value:function(t,e,n){this.rotation[0]=t,this.rotation[1]=e,this.rotation[2]=n}},{key:"setRotationPoint",value:function(t,e,n){this.rotationPoint=[t,e,n]}},{key:"setParentRotation",value:function(t,e,n){this.parentRotation=[t,e,n]}},{key:"update",value:function(){}},{key:"setNormals",value:function(t){this.normals=t,this._normalBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._normalBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(this.normals),this.webGL.STATIC_DRAW)}}]),e}(),V=function(){function n(t){s()(this,n),this.polygons=new Array(2),this.position=[0,0,0],this.rotationPoint=[0,0,0];var e=new H(t);e.setVertexes([0,0,0,100,100,0,0,100,0]),e.setTextureCoords([0,1,1,0,0,0]),this.polygons[0]=e,(e=new H(t)).setVertexes([100,100,0,0,0,0,100,0,0]),e.setTextureCoords([1,0,0,1,1,1]),this.polygons[1]=e,this.setNormals([0,0,1,0,0,1,0,0,1])}return c()(n,[{key:"setTexture",value:function(t){this.polygons[0].setTexture(t),this.polygons[1].setTexture(t)}},{key:"setSize",value:function(t,e){this.width=t,this.height=e,this.polygons[0].setVertexes([0,0,0,t,e,0,0,e,0]),this.polygons[1].setVertexes([t,e,0,0,0,0,t,0,0])}},{key:"setPosition",value:function(t,e,n){this.position=[t,e,n],this.polygons[0].setPosition(t,e,n),this.polygons[1].setPosition(t,e,n)}},{key:"rotate",value:function(t,e,n){var i=a(t),o=a(e),r=a(n);this.polygons[0].rotate(i,o,r),this.polygons[1].rotate(i,o,r)}},{key:"setParentRotation",value:function(t,e,n){this.polygons[0].setParentRotation(t,e,n),this.polygons[1].setParentRotation(t,e,n)}},{key:"setRotationPoint",value:function(t,e,n){this.polygons[0].setRotationPoint(t,e,n),this.polygons[1].setRotationPoint(t,e,n)}},{key:"setNormals",value:function(t){this.polygons[0].setNormals(t),this.polygons[1].setNormals(t)}}]),n}(),X=function(){function e(t){s()(this,e),this.faces=[new V(t),new V(t),new V(t),new V(t),new V(t),new V(t)],this.position=[0,0,0],this.rotation=[0,0,0],this.faces[0].rotate(0,0,0),this.faces[0].setRotationPoint(-100,-100,100),this.faces[0].setPosition(0,0,0),this.faces[0].setNormals([0,0,1,0,0,1,0,0,1]),this.faces[1].rotate(0,90,0),this.faces[1].setRotationPoint(-100,-100,100),this.faces[1].position=[0,0,0],this.faces[1].setNormals([1,0,0,1,0,0,1,0,0]),this.faces[2].rotate(0,-180,0),this.faces[2].setRotationPoint(-100,-100,100),this.faces[2].position=[0,0,0],this.faces[2].setNormals([0,0,-1,0,0,-1,0,0,-1]),this.faces[3].rotate(0,270,0),this.faces[3].setRotationPoint(-100,-100,100),this.faces[3].position=[0,0,0],this.faces[3].setNormals([-1,0,0,-1,0,0,-1,0,0]),this.faces[4].rotate(-90,0,0),this.faces[4].setRotationPoint(-100,-100,100),this.faces[4].position=[0,0,0],this.faces[4].setNormals([0,1,0,0,1,0,0,1,0]),this.faces[5].rotate(90,0,0),this.faces[5].setRotationPoint(-100,-100,100),this.faces[5].position=[0,0,0],this.faces[5].setNormals([0,-1,0,0,-1,0,0,-1,0])}return c()(e,[{key:"_updateFaces",value:function(){this.faces[0].setPosition(this.position[0],this.position[1],this.position[2])}},{key:"setTexture",value:function(t,e,n,i,o,r){this.faces[0].setTexture(t),this.faces[1].setTexture(e),this.faces[2].setTexture(n),this.faces[3].setTexture(i),this.faces[4].setTexture(o),this.faces[5].setTexture(r)}},{key:"setSize",value:function(e,n,i){this.width=e,this.height=n,this.depth=i,this.faces.forEach(function(t){t.setSize(e,n),t.setRotationPoint(-e/2,-n/2,i/2)})}},{key:"setPosition",value:function(t,e,n){this.position=[t,e,n],this.faces[0].setPosition(t,e,n),this.faces[1].setPosition(t,e,n),this.faces[2].setPosition(t,e,n),this.faces[3].setPosition(t,e,n),this.faces[4].setPosition(t,e,n),this.faces[5].setPosition(t,e,n)}},{key:"rotate",value:function(t,e,n){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=n;var i=a(this.rotation[0]),o=a(this.rotation[1]),r=a(this.rotation[2]);this.faces.forEach(function(t){t.setParentRotation(i,o,r)})}},{key:"setRotation",value:function(t,e,n){var i=a(t),o=a(e),r=a(n);this.faces.forEach(function(t){t.setParentRotation(i,o,r)})}},{key:"animation",value:function(){this.rotate(1,1,1)}},{key:"animate",value:function(t,e){e=e||this.animation,this._animationInterval=setInterval(e,1e3/t)}},{key:"removeAnimation",value:function(){clearInterval(this._animationInterval)}}]),e}();n.d(e,"radToDeg",function(){return i}),n.d(e,"degToRad",function(){return a}),n.d(e,"isPowerOf2",function(){return o}),n.d(e,"Matrix",function(){return h}),n.d(e,"unit",function(){return l}),n.d(e,"translation",function(){return f}),n.d(e,"rotationX",function(){return y}),n.d(e,"rotationY",function(){return w}),n.d(e,"rotationZ",function(){return x}),n.d(e,"scaling",function(){return m}),n.d(e,"multiply",function(){return L}),n.d(e,"vec3Multiply",function(){return v}),n.d(e,"transformVector",function(){return g}),n.d(e,"inverse",function(){return _}),n.d(e,"normalize",function(){return b}),n.d(e,"Engine",function(){return M}),n.d(e,"Camera",function(){return I}),n.d(e,"Controls",function(){return N}),n.d(e,"Debugger",function(){return Y}),n.d(e,"Texture",function(){return j}),n.d(e,"Rect",function(){return V}),n.d(e,"Cube",function(){return X}),n.d(e,"Object",function(){return U}),n.d(e,"Map",function(){return S})}])});