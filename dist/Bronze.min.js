!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Bronze",[],e):"object"==typeof exports?exports.Bronze=e():t.Bronze=e()}(window,function(){return function(i){var n={};function o(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=i,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/dist",o(o.s=15)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}},function(i,t){function n(t,e){return i.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(t,e)}i.exports=n},function(e,t){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}e.exports=i},function(t,e,i){t.exports=i(9)},function(t,e){function u(t,e,i,n,o,r,s){try{var a=t[r](s),u=a.value}catch(t){return void i(t)}a.done?e(u):Promise.resolve(u).then(n,o)}t.exports=function(a){return function(){var t=this,s=arguments;return new Promise(function(e,i){var n=a.apply(t,s);function o(t){u(n,e,i,o,r,"next",t)}function r(t){u(n,e,i,o,r,"throw",t)}o(void 0)})}}},function(t,e,i){var n=i(11),o=i(12);t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?o(t):e}},function(t,e,i){var n=i(2);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}},function(e,t,i){var n=i(3),o=i(2),r=i(13),s=i(14);function a(t){var i="function"==typeof Map?new Map:void 0;return e.exports=a=function(t){if(null===t||!r(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(t))return i.get(t);i.set(t,e)}function e(){return s(t,arguments,n(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o(e,t)},a(t)}e.exports=a},function(t,e,i){var n=function(){return this||"object"==typeof self&&self}()||Function("return this")(),o=n.regeneratorRuntime&&0<=Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime"),r=o&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=i(10),o)n.regeneratorRuntime=r;else try{delete n.regeneratorRuntime}catch(t){n.regeneratorRuntime=void 0}},function(B,t){!function(t){"use strict";var u,e=Object.prototype,c=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",n=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag",s="object"==typeof B,a=t.regeneratorRuntime;if(a)s&&(B.exports=a);else{(a=t.regeneratorRuntime=s?B.exports:{}).wrap=w;var l="suspendedStart",f="suspendedYield",m="executing",v="completed",d={},h={};h[o]=function(){return this};var p=Object.getPrototypeOf,b=p&&p(p(P([])));b&&b!==e&&c.call(b,o)&&(h=b);var y=_.prototype=g.prototype=Object.create(h);L.prototype=y.constructor=_,_.constructor=L,_[r]=L.displayName="GeneratorFunction",a.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===L||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,r in t||(t[r]="GeneratorFunction")),t.prototype=Object.create(y),t},a.awrap=function(t){return{__await:t}},G(R.prototype),R.prototype[n]=function(){return this},a.AsyncIterator=R,a.async=function(t,e,i,n){var o=new R(w(t,e,i,n));return a.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},G(y),y[r]="Generator",y[o]=function(){return this},y.toString=function(){return"[object Generator]"},a.keys=function(i){var n=[];for(var t in i)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in i)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=P,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var n=this;function t(t,e){return r.type="throw",r.arg=i,n.next=t,e&&(n.method="next",n.arg=u),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],r=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var s=c.call(o,"catchLoc"),a=c.call(o,"finallyLoc");if(s&&a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;0<=i;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&c.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=t,r.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),A(i),d}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var o=n.arg;A(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=u),d}}}function w(t,e,i,n){var r,s,a,u,o=e&&e.prototype instanceof g?e:g,c=Object.create(o.prototype),h=new T(n||[]);return c._invoke=(r=t,s=i,a=h,u=l,function(t,e){if(u===m)throw new Error("Generator is already running");if(u===v){if("throw"===t)throw e;return F()}for(a.method=t,a.arg=e;;){var i=a.delegate;if(i){var n=E(i,a);if(n){if(n===d)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(u===l)throw u=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);u=m;var o=x(r,s,a);if("normal"===o.type){if(u=a.done?v:f,o.arg===d)continue;return{value:o.arg,done:a.done}}"throw"===o.type&&(u=v,a.method="throw",a.arg=o.arg)}}),c}function x(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function g(){}function L(){}function _(){}function G(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function R(u){var e;this._invoke=function(i,n){function t(){return new Promise(function(t,e){!function e(t,i,n,o){var r=x(u[t],u,i);if("throw"!==r.type){var s=r.arg,a=s.value;return a&&"object"==typeof a&&c.call(a,"__await")?Promise.resolve(a.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):Promise.resolve(a).then(function(t){s.value=t,n(s)},function(t){return e("throw",t,n,o)})}o(r.arg)}(i,n,t,e)})}return e=e?e.then(t,t):t()}}function E(t,e){var i=t.iterator[e.method];if(i===u){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=u,E(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=x(i,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,d;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(c.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=u,t.done=!0,t};return n.next=n}}return{next:F}}function F(){return{value:u,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(e,t){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t){return"function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?e.exports=n=function(t){return i(t)}:e.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)},n(t)}e.exports=n},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(n,t,e){var r=e(2);function o(t,e,i){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?n.exports=o=function(t,e,i){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return i&&r(o,i.prototype),o}:n.exports=o=Reflect.construct,o.apply(null,arguments)}n.exports=o},function(t,e,i){"use strict";function n(t){return 180*t/Math.PI}function s(t){return t*Math.PI/180}function o(t){return 0==(t&t-1)}i.r(e);var r=i(0),a=i.n(r),u=i(1),c=i.n(u),h=function(){function t(){return a()(this,t),this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this}return c()(t,[{key:"perspective",value:function(t,e,i,n,o){var r=Math.tan(.5*Math.PI-.5*t),s=1/(n-o);return this.matrix=[r/(e/i),0,0,0,0,r,0,0,0,0,(n+o)*s,-1,0,0,n*o*s*2,0],this}},{key:"projection",value:function(t,e){return this.matrix=[2/t,0,0,0,-2/e,0,-1,1,1],this}},{key:"multiply",value:function(t){var e=this.matrix[0],i=this.matrix[1],n=this.matrix[2],o=this.matrix[3],r=this.matrix[4],s=this.matrix[5],a=this.matrix[6],u=this.matrix[7],c=this.matrix[8],h=this.matrix[9],l=this.matrix[10],f=this.matrix[11],m=this.matrix[12],v=this.matrix[13],d=this.matrix[14],p=this.matrix[15],b=t[0],y=t[1],w=t[2],x=t[3],g=t[4],L=t[5],_=t[6],G=t[7],R=t[8],E=t[9],k=t[10],A=t[11],T=t[12],P=t[13],F=t[14],B=t[15];this.matrix=[b*e+y*r+w*c+x*m,b*i+y*s+w*h+x*v,b*n+y*a+w*l+x*d,b*o+y*u+w*f+x*p,g*e+L*r+_*c+G*m,g*i+L*s+_*h+G*v,g*n+L*a+_*l+G*d,g*o+L*u+_*f+G*p,R*e+E*r+k*c+A*m,R*i+E*s+k*h+A*v,R*n+E*a+k*l+A*d,R*o+E*u+k*f+A*p,T*e+P*r+F*c+B*m,T*i+P*s+F*h+B*v,T*n+P*a+F*l+B*d,T*o+P*u+F*f+B*p]}},{key:"multiply_",value:function(t){var e=this.matrix[0],i=this.matrix[1],n=this.matrix[2],o=this.matrix[3],r=this.matrix[4],s=this.matrix[5],a=this.matrix[6],u=this.matrix[7],c=this.matrix[8],h=this.matrix[9],l=this.matrix[10],f=this.matrix[11],m=this.matrix[12],v=this.matrix[13],d=this.matrix[14],p=this.matrix[15],b=t[0],y=t[1],w=t[2],x=t[3],g=t[4],L=t[5],_=t[6],G=t[7],R=t[8],E=t[9],k=t[10],A=t[11],T=t[12],P=t[13],F=t[14],B=t[15];return[b*e+y*r+w*c+x*m,b*i+y*s+w*h+x*v,b*n+y*a+w*l+x*d,b*o+y*u+w*f+x*p,g*e+L*r+_*c+G*m,g*i+L*s+_*h+G*v,g*n+L*a+_*l+G*d,g*o+L*u+_*f+G*p,R*e+E*r+k*c+A*m,R*i+E*s+k*h+A*v,R*n+E*a+k*l+A*d,R*o+E*u+k*f+A*p,T*e+P*r+F*c+B*m,T*i+P*s+F*h+B*v,T*n+P*a+F*l+B*d,T*o+P*u+F*f+B*p]}},{key:"translate",value:function(t,e,i){this.multiply(f(t,e,i))}},{key:"translate_",value:function(t,e,i){return this.multiply_(f(t,e,i))}},{key:"rotateX",value:function(t){this.multiply(y(t))}},{key:"rotateY",value:function(t){this.multiply(w(t))}},{key:"rotateZ",value:function(t){this.multiply(x(t))}},{key:"scale",value:function(t,e,i){this.multiply(m(t,e,i))}}]),t}();function l(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function f(t,e,i){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1]}function y(t){var e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]}function w(t){var e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]}function x(t){var e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]}function m(t,e,i){return[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1]}function g(t,e){var i=t[0],n=t[1],o=t[2],r=t[3],s=t[4],a=t[5],u=t[6],c=t[7],h=t[8],l=t[9],f=t[10],m=t[11],v=t[12],d=t[13],p=t[14],b=t[15],y=e[0],w=e[1],x=e[2],g=e[3],L=e[4],_=e[5],G=e[6],R=e[7],E=e[8],k=e[9],A=e[10],T=e[11],P=e[12],F=e[13],B=e[14],O=e[15];return[y*i+w*s+x*h+g*v,y*n+w*a+x*l+g*d,y*o+w*u+x*f+g*p,y*r+w*c+x*m+g*b,L*i+_*s+G*h+R*v,L*n+_*a+G*l+R*d,L*o+_*u+G*f+R*p,L*r+_*c+G*m+R*b,E*i+k*s+A*h+T*v,E*n+k*a+A*l+T*d,E*o+k*u+A*f+T*p,E*r+k*c+A*m+T*b,P*i+F*s+B*h+O*v,P*n+F*a+B*l+O*d,P*o+F*u+B*f+O*p,P*r+F*c+B*m+O*b]}function v(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3]]}function L(t,e){for(var i=new Float32Array(4),n=0;n<4;++n)for(var o=i[n]=0;o<4;++o)i[n]+=e[o]*t[4*o+n];return i}function _(t){var e=new Float32Array(16),i=t[0],n=t[1],o=t[2],r=t[3],s=t[4],a=t[5],u=t[6],c=t[7],h=t[8],l=t[9],f=t[10],m=t[11],v=t[12],d=t[13],p=t[14],b=t[15],y=f*b,w=p*m,x=u*b,g=p*c,L=u*m,_=f*c,G=o*b,R=p*r,E=o*m,k=f*r,A=o*c,T=u*r,P=h*d,F=v*l,B=s*d,O=v*a,U=s*l,C=h*a,j=i*d,S=v*n,I=i*l,M=h*n,D=i*a,N=s*n,Y=y*a+g*l+L*d-(w*a+x*l+_*d),z=w*n+G*l+k*d-(y*n+R*l+E*d),H=x*n+R*a+A*d-(g*n+G*a+T*d),X=_*n+E*a+T*l-(L*n+k*a+A*l),V=1/(i*Y+s*z+h*H+v*X);return e[0]=V*Y,e[1]=V*z,e[2]=V*H,e[3]=V*X,e[4]=V*(w*s+x*h+_*v-(y*s+g*h+L*v)),e[5]=V*(y*i+R*h+E*v-(w*i+G*h+k*v)),e[6]=V*(g*i+G*s+T*v-(x*i+R*s+A*v)),e[7]=V*(L*i+k*s+A*h-(_*i+E*s+T*h)),e[8]=V*(P*c+O*m+U*b-(F*c+B*m+C*b)),e[9]=V*(F*r+j*m+M*b-(P*r+S*m+I*b)),e[10]=V*(B*r+S*c+D*b-(O*r+j*c+N*b)),e[11]=V*(C*r+I*c+N*m-(U*r+M*c+D*m)),e[12]=V*(B*f+C*p+F*u-(U*p+P*u+O*f)),e[13]=V*(I*p+P*o+S*f-(j*f+M*p+F*o)),e[14]=V*(j*u+N*p+O*o-(D*p+B*o+S*u)),e[15]=V*(D*f+U*o+M*u-(I*u+N*f+C*o)),e}function d(t){var e=new Float32Array(3),i=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return 1e-5<i&&(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i,e)}var p=i(4),b=i.n(p),G=i(5),R=i.n(G);function E(t,e,i){var n,o=t;if("fragment"==e)n=i.createShader(i.FRAGMENT_SHADER);else{if("vertex"!=e)return console.log("Wrong shader type"),null;n=i.createShader(i.VERTEX_SHADER)}if(i.shaderSource(n,o),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw"Could not compile shader:"+i.getShaderInfoLog(n);return n}var k,A=i(6),T=i.n(A),P=i(3),F=i.n(P),B=i(7),O=i.n(B),U=i(8),C=function(t){function o(t,e,i){var n;return a()(this,o),(n=T()(this,F()(o).call(this))).src=t,null!=e&&null!=i&&(n.width=e,n.height=i),n.coords=[],n.addEventListener("load",function(){n.loaded=!0}),n.color=new Uint8Array([255,255,255,255]),n._textureBlockLocation=null,n}return O()(o,t),c()(o,[{key:"scale",value:function(t,e){this.width=width*t,this.height=height*e}},{key:"setCoords",value:function(t){this.coords=t}},{key:"setColorRGBA",value:function(t,e,i,n){this.color=new Uint8Array([t,e,i,n])}}]),o}(i.n(U)()(Image)),j=function(){function e(t){a()(this,e),t.objects.push(this),this.engine=t,this.webGL=t.webGL,this.camera=t.camera,this.texture=t.noTexture,this.position=[0,0,0],this.rotation=[0,0,0],this.scaling=[1,1,1],this.rotationPoint=[0,0,0],this.parentRotation=[0,0,0],this.relativeCameraPosition=null,this.faces=[],this.collisionBoxes=[],this.UIElement=!1}return c()(e,[{key:"setTexture",value:function(t){this.texture=t}},{key:"setPosition",value:function(t,e,i){this.position[0]=t,this.position[1]=e,this.position[2]=i}},{key:"move",value:function(t,e,i){this.position[0]+=t,this.position[1]+=e,this.position[2]+=i}},{key:"moveRelativeToTheCamera",value:function(t,e,i){var n=[t,e,i,1];n=v(this.camera.inventedMatrix,n),this.position[0]+=n[0],this.position[1]+=n[1],this.position[2]+=n[2]}},{key:"rotate",value:function(t,e,i){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=i}},{key:"setRotation",value:function(t,e,i){this.rotation[0]=t,this.rotation[1]=e,this.rotation[2]=i}},{key:"setRotationPoint",value:function(t,e,i){this.rotationPoint=[t,e,i]}},{key:"setParentRotation",value:function(t,e,i){this.parentRotation=[t,e,i]}},{key:"scale",value:function(t,e,i){this.scaling=[t,e,i]}},{key:"animation",value:function(){this.rotate(0,0,0)}},{key:"animate",value:function(t,e){e=e||this.animation,setInterval(e,1e3/t)}},{key:"destroy",value:function(){this.engine.splice(this.engine.objects.indexOf(this),1)}},{key:"compile",value:function(t){var l=this,f=[],m=[],v=[],e=t.split("\n"),a={x:[0,0],y:[0,0],z:[0,0]};e.forEach(function(t){for(var h=t.split(" "),e=h.length;e--;)""!=h[e]&&"\r"!=h[e]||h.splice(e,1);if("v"==h[0]){var i=parseFloat(h[1]),n=parseFloat(h[2]),o=parseFloat(h[3]);a.x[1]<i&&(a.x[1]=i),a.y[1]<n&&(a.y[1]=n),a.z[1]<o&&(a.z[1]=o),a.x[0]>i&&(a.x[0]=i),a.y[0]>n&&(a.y[0]=n),a.z[0]>o&&(a.z[0]=o),f.push([i,n,o])}else if("vn"==h[0])v.push([parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])]);else if("vt"==h[0])m.push([parseFloat(h[1]),parseFloat(h[2])]);else if("f"==h[0])for(var r=function(t){var e=h[t].split("/");if("\r"==e[length-1])return"break";for(var i=null,n=null,o=void 0,r=0;r<l.faces.length;r++){var s=l.faces[r];s.vertexesCount==h.length-1&&(i=s.vertexes,n=s.textureCoords,o=s.normals)}null==i&&(l.faces.push({vertexesCount:h.length-1,vertexes:[],textureCoords:[],normals:[]}),i=l.faces[l.faces.length-1].vertexes,n=l.faces[l.faces.length-1].textureCoords,o=l.faces[l.faces.length-1].normals);var a=parseFloat(e[0]);a<0&&(a=f.length+a+1);var u=parseFloat(e[1]);u<0&&(u=m.length+u+1);var c=parseFloat(e[2]);c<0&&(c=v.length+c+1),f[a-1].forEach(function(t){i.push(t)}),0<m.length&&m[u-1].forEach(function(t){n.push(t)}),null!=e[2]?v[c-1].forEach(function(t){o.push(t)}):o.push(0,0,0)},s=1;s<h.length;s++){if("break"===r(s))break}});for(var i=0;i<this.faces.length;i++){var n=this.faces[i];n.vertexesBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,n.vertexesBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(n.vertexes),this.webGL.STATIC_DRAW),n.coordsBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,n.coordsBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(n.textureCoords),this.webGL.STATIC_DRAW),n.normalBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,n.normalBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(n.normals),this.webGL.STATIC_DRAW)}this.collisionBoxes.push(a)}},{key:"loadFromObj",value:function(t){var e=this,i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=function(){4==i.readyState&&e.compile(i.responseText)},i.send()}}]),e}(),S=function(){function e(t){a()(this,e),this.engine=t,this.objects=[],this.lands=[],this.camera}return c()(e,[{key:"createObject",value:function(){var t=new j(engine);return this.engine.objects.push(t),t}},{key:"addObject",value:function(t){this.objects.push(t)}},{key:"removeObject",value:function(t){var e=this.objects.indexOf(t);return-1!=e&&(this.objects.splice(e,1),!0)}},{key:"removeObjectByName",value:function(e){var i=this;return this.objects.forEach(function(t){if(t.name==e)return i.removeObject(t),!0}),!1}}]),e}(),I=function(){function n(t){var e,i;a()(this,n),this.div=t,this.div.style="position: relative;",this.canvas=document.createElement("canvas"),this.canvas.width=t.width,this.canvas.height=t.height,t.appendChild(this.canvas),this.webGL=(e=this.canvas,i=e.getContext("experimental-webgl"),window.addEventListener("resize",function(){e.width=e.offsetWidth,e.height=e.offsetHeight}),i),this.width=t.width,this.height=t.height,this.polygons=[],this.objects=[],this.ui=null,this.textures=[],this.camera=null,this.debugger=null,this.controls=null,this.selectedObject=null,this._globalPositionBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._globalPositionBuffer),this._globalTextureBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._globalTextureBuffer),this._initShaders(),this.noTexture=new C,this.noTexture.setColorRGBA(219,58,52,255),this.bindTexture(this.noTexture),this._objectSelectHandler}var t;return c()(n,[{key:"_initShaders",value:function(){var t,e,i,n,o,r=E("attribute vec4 a_position;\r\nattribute vec2 a_texcoord;\r\nattribute vec4 a_normal;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mat4 u_objectRotation;\r\nuniform vec3 u_lightWorldPosition;\r\nuniform mat4 u_cameraMatrix;\r\n\r\nvarying vec2 v_texcoord;\r\nvarying vec3 v_normal;\r\nvarying vec3 v_surfaceToLight;\r\n\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * a_position;\r\n    \r\n    v_texcoord = a_texcoord;\r\n    v_normal = vec3(u_objectRotation * a_normal);\r\n\r\n    vec3 surfaceWorldPosition = (u_cameraMatrix * a_position).xyz;\r\n    \r\n    v_surfaceToLight = u_lightWorldPosition; // - surfaceWorldPosition;\r\n}","vertex",this.webGL),s=E("precision mediump float;\r\n\r\nvarying vec2 v_texcoord;\r\nvarying vec3 v_normal;\r\n\r\nuniform sampler2D u_texture;\r\nuniform vec3 u_reverseLightDirection;\r\nvarying vec3 v_surfaceToLight;\r\n\r\nvoid main() {\r\n    vec3 normal = normalize(v_normal);\r\n    // float light = dot(normal, u_reverseLightDirection);\r\n    vec3 surfaceToLightDirection = normalize(v_surfaceToLight);\r\n    float light = dot(v_normal, surfaceToLightDirection);\r\n    if (light < 0.5)\r\n        light = 0.5;\r\n    \r\n    gl_FragColor = texture2D(u_texture, v_texcoord);\r\n    gl_FragColor.rgb *= (light);\r\n    if(gl_FragColor.a < 0.2)\r\n        discard;\r\n}","fragment",this.webGL);this.shaderProgram=(t=this.webGL,e=r,i=s,n=!1,o=t.createProgram(),t.attachShader(o,e),t.attachShader(o,i),t.linkProgram(o),t.useProgram(o),n&&(t.deleteShader(e),t.deleteShader(i)),o),this.positionLocation=this.webGL.getAttribLocation(this.shaderProgram,"a_position"),this.textureCoordinatesLocation=this.webGL.getAttribLocation(this.shaderProgram,"a_texcoord"),this.textureLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_texture"),this.matrixLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_matrix"),this.objectRotationLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_objectRotation"),this.normalLocation=this.webGL.getAttribLocation(this.shaderProgram,"a_normal"),this.reverseLightDirectionLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_reverseLightDirection"),this.lightWorldPositionLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_lightWorldPosition"),this.cameraLocation=this.webGL.getUniformLocation(this.shaderProgram,"u_cameraMatrix"),this.webGL.useProgram(this.shaderProgram),this.webGL.viewport(0,0,this.width,this.height),this.webGL.enable(this.webGL.CULL_FACE),this.webGL.enable(this.webGL.DEPTH_TEST)}},{key:"setCamera",value:function(t){this.camera=t}},{key:"canvasResized",value:function(){this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.webGL.viewport(0,0,this.width,this.height)}},{key:"onObjectSelect",value:function(t){this._objectSelectHandler=t}},{key:"bindTexture",value:function(t){var e=this;t._textureBlockLocation=this.textures.length,this.textures.push(t),t._WebGLtexture=this.webGL.createTexture(),this.webGL.activeTexture(this.webGL.TEXTURE0+t._textureBlockLocation),this.webGL.bindTexture(this.webGL.TEXTURE_2D,t._WebGLtexture),t.loaded?(this.webGL.texImage2D(this.webGL.TEXTURE_2D,0,this.webGL.RGBA,this.webGL.RGBA,this.webGL.UNSIGNED_BYTE,t),this.webGL.generateMipmap(this.webGL.TEXTURE_2D),o(image.width)&&o(image.height)?this.webGL.generateMipmap(this.webGL.TEXTURE_2D):(this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_WRAP_S,this.webGL.CLAMP_TO_EDGE),this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_WRAP_T,this.webGL.CLAMP_TO_EDGE),this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_MIN_FILTER,this.webGL.LINEAR))):(this.webGL.texImage2D(this.webGL.TEXTURE_2D,0,this.webGL.RGBA,1,1,0,this.webGL.RGBA,this.webGL.UNSIGNED_BYTE,t.color),t.addEventListener("load",function(){e.webGL.activeTexture(e.webGL.TEXTURE0+t._textureBlockLocation),e.webGL.texImage2D(e.webGL.TEXTURE_2D,0,e.webGL.RGBA,e.webGL.RGBA,e.webGL.UNSIGNED_BYTE,t),o(t.width)&&o(t.height)?e.webGL.generateMipmap(e.webGL.TEXTURE_2D):(e.webGL.texParameteri(e.webGL.TEXTURE_2D,e.webGL.TEXTURE_WRAP_S,e.webGL.CLAMP_TO_EDGE),e.webGL.texParameteri(e.webGL.TEXTURE_2D,e.webGL.TEXTURE_WRAP_T,e.webGL.CLAMP_TO_EDGE),e.webGL.texParameteri(e.webGL.TEXTURE_2D,e.webGL.TEXTURE_MIN_FILTER,e.webGL.LINEAR))}))}},{key:"_update",value:function(){var d,e,i,n,p=this;null!=this.camera._controlFunction&&(this.camera._controlFunction(),this.controls.mouse.movement.x=0,this.controls.mouse.movement.y=0),this.selectedObject=null,this.polygons.forEach(function(t){(d=new h).perspective(p.camera.fieldOfViewRad,p.width,p.height,1,2e4),t.UIElement||d.multiply(p.camera.inventedMatrix),(n=new h).multiply(_(f(t.rotationPoint[0],t.rotationPoint[1],t.rotationPoint[2]))),n.translate(t.position[0],t.position[1],t.position[2]),e=g(e=g(y(t.rotation[0]),w(t.rotation[1])),x(t.rotation[2])),null!=t.parentRotation&&(i=g(i=g(y(t.parentRotation[0]),w(t.parentRotation[1])),x(t.parentRotation[2])),t._world=i,e=g(i,e)),n.multiply(e),n.translate(t.rotationPoint[0],t.rotationPoint[1],t.rotationPoint[2]),n.scale(1,1,1),d.multiply(n.matrix),t._matrix=d.matrix,t._rotationMatrix=e});var b=null;this.objects.forEach(function(m){if((d=new h).perspective(p.camera.fieldOfViewRad,p.width,p.height,1,2e4),m.UIElement||d.multiply(p.camera.inventedMatrix),(n=new h).multiply(_(f(m.rotationPoint[0],m.rotationPoint[1],m.rotationPoint[2]))),n.translate(m.position[0],m.position[1],m.position[2]),e=g(e=g(y(m.rotation[0]),w(m.rotation[1])),x(m.rotation[2])),i=g(i=g(y(m.parentRotation[0]),w(m.parentRotation[1])),x(m.parentRotation[2])),m._world=i,e=g(i,e),n.multiply(e),n.translate(m.rotationPoint[0],m.rotationPoint[1],m.rotationPoint[2]),n.scale(m.scaling[0],m.scaling[1],m.scaling[2]),d.multiply(n.matrix),!m.UIElement){var v=!1;m.collisionBoxes.forEach(function(t){for(var e=[],i=0;i<t.x.length;i++)for(var n=t.x[i],o=0;o<t.y.length;o++)for(var r=t.y[o],s=0;s<t.z.length;s++){var a=t.z[s],u=L(d.matrix,[n,r,a,1]);u[0]=u[0]/u[3],u[1]=u[1]/u[3],u[0]=(.5*u[0]+.5)*p.width,u[1]=(-.5*u[1]+.5)*p.height,u[0]=u[0]<0?0:u[0],u[1]=u[1]<0?0:u[1],u[0]=u[0]>p.width?p.width:u[0],u[1]=u[1]>p.height?p.height:u[1],0<=u[2]&&e.push(u)}for(var c=[1e4,1e4,-1e3],h=[-1e4,-1e4],l=0;l<e.length;l++){var f=e[l];f[0]<c[0]?c[0]=f[0]:f[0]>h[0]&&(h[0]=f[0]),f[1]<c[1]?c[1]=f[1]:f[1]>h[1]&&(h[1]=f[1]),f[2]>c[2]&&(c[2]=f[2])}m.relativeCameraPosition={x:{left:c[0],right:h[0]},y:{top:h[1],bottom:c[1]},depth:c[2]},p.controls.mouse.x>c[0]&&p.controls.mouse.x<h[0]&&p.controls.mouse.y>c[1]&&p.controls.mouse.y<h[1]&&(v=!0);p.controls.mouse;v&&(null==b&&(b=m),b.relativeCameraPosition.depth>=c[2]&&(b=m))})}p.selectedObject=b,m.UIElement||p.selectedObject||null==p._objectSelectHandler||p._objectSelectHandler(b),m._matrix=d.matrix,m._rotationMatrix=e})}},{key:"_draw",value:function(){var i=this;this.webGL.clear(this.webGL.COLOR_BUFFER_BIT|this.webGL.DEPTH_BUFFER_BIT),this.webGL.uniform3fv(this.reverseLightDirectionLocation,d([-.1,.5,1])),this.webGL.uniform3fv(this.lightWorldPositionLocation,[0,100,400]),this.webGL.uniformMatrix4fv(this.cameraLocation,!1,this.camera.matrix),this.polygons.forEach(function(t){i.webGL.enableVertexAttribArray(i.positionLocation),i.webGL.bindBuffer(i.webGL.ARRAY_BUFFER,t._vertexesBuffer),i.webGL.vertexAttribPointer(i.positionLocation,3,i.webGL.FLOAT,!1,0,0),i.webGL.enableVertexAttribArray(i.textureCoordinatesLocation),i.webGL.bindBuffer(i.webGL.ARRAY_BUFFER,t._coordsBuffer),i.webGL.vertexAttribPointer(i.textureCoordinatesLocation,2,i.webGL.FLOAT,!1,0,0),i.webGL.enableVertexAttribArray(i.normalLocation),i.webGL.bindBuffer(i.webGL.ARRAY_BUFFER,t._normalBuffer),i.webGL.vertexAttribPointer(i.normalLocation,3,i.webGL.FLOAT,!1,0,0),i.webGL.uniform1i(i.textureLocation,t.texture._textureBlockLocation),i.webGL.uniformMatrix4fv(i.matrixLocation,!1,t._matrix),i.webGL.uniformMatrix4fv(i.objectRotationLocation,!1,t._world),i.webGL.drawArrays(i.webGL.TRIANGLES,0,3)}),this.objects.forEach(function(e){e.faces.forEach(function(t){i.webGL.enableVertexAttribArray(i.positionLocation),i.webGL.bindBuffer(i.webGL.ARRAY_BUFFER,t.vertexesBuffer),i.webGL.vertexAttribPointer(i.positionLocation,3,i.webGL.FLOAT,!1,0,0),i.webGL.enableVertexAttribArray(i.textureCoordinatesLocation),i.webGL.bindBuffer(i.webGL.ARRAY_BUFFER,t.coordsBuffer),i.webGL.vertexAttribPointer(i.textureCoordinatesLocation,2,i.webGL.FLOAT,!1,0,0),i.webGL.enableVertexAttribArray(i.normalLocation),i.webGL.bindBuffer(i.webGL.ARRAY_BUFFER,t.normalBuffer),i.webGL.vertexAttribPointer(i.normalLocation,3,i.webGL.FLOAT,!1,0,0),i.webGL.uniform1i(i.textureLocation,e.texture._textureBlockLocation),i.webGL.uniformMatrix4fv(i.matrixLocation,!1,e._matrix),i.webGL.uniformMatrix4fv(i.objectRotationLocation,!1,e._world),i.webGL.drawArrays(i.webGL.TRIANGLES,0,t.vertexes.length/t.vertexesCount)}),i.webGL.enable(i.webGL.DEPTH_TEST)}),null!=this.debugger&&this.debugger.updateInfo()}},{key:"_drawUI",value:function(){null!==this.ui&&this.ui._draw()}},{key:"render",value:(t=R()(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._update();case 2:return t.next=4,this._draw();case 4:return t.next=6,this._drawUI();case 6:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"run",value:function(){k=this,console.log(),console.log("     %c%s","color: rgba(247, 137, 74, 1); text-align: center; font-size: 16px; font-weight: 700","Bronze Engine is running"),console.log(),console.info("     Version : 0.0.1"),console.info("     Docs    : http://m0ksem.design/Bronze-Engine/docs/global"),console.info("     GitHub  : https://github.com/m0ksem/Bronze-Engine"),console.log(),M()}}]),n}();function M(){requestAnimationFrame(M),k.render()}!function(){for(var r=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var i=(new Date).getTime(),n=Math.max(0,16-(i-r)),o=window.setTimeout(function(){t(i+n)},n);return r=i+n,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var D=function(){function t(){a()(this,t),this.position=[0,0,100],this.up=[0,1,0],this.target=[0,0,0],this.fieldOfView=90,this.fieldOfViewRad=s(90),this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.rotation=[0,0,0],this._collisions=!1,this._lookUpMatrix=null}return c()(t,[{key:"setFieldOfView",value:function(t){this.fieldOfView=t,this.fieldOfViewRad=s(t)}},{key:"setCollisions",value:function(t){this._collisions=t}},{key:"setPosition",value:function(t,e,i){this.position=[t,e,i],this.computeMatrix()}},{key:"move",value:function(t,e,i){this.position[0]+=t,this.position[1]+=e,this.position[2]+=i,this.computeMatrix()}},{key:"rotate",value:function(t,e,i){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=i,this.computeMatrix()}},{key:"setRotation",value:function(t,e,i){this.rotation=[t,e,i],this.computeMatrix()}},{key:"computeMatrix",value:function(){this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.matrix=g(this.matrix,f(this.position[0],this.position[1],this.position[2]));var t=new h;t.multiply(w(s(this.rotation[1]))),t.multiply(y(s(this.rotation[0]))),t.multiply(x(s(this.rotation[2]))),this.matrix=g(this.matrix,t.matrix),null!=this._lookUpMatrix&&(this.matrix=g(this.matrix,this.lookAt(camera._lookUpMatrix,[0,1,0]))),this.rotationMatrix=_(t.matrix),this.inventedMatrix=_(this.matrix)}},{key:"setControl",value:function(t){this._controlFunction=t}},{key:"setLookUp",value:function(t,e,i){this._lookUpMatrix=null!=t?[t,e,i]:null}},{key:"lookAt",value:function(t,e){if(null==t)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];var i=normalize(subVec3(this.position,t)),n=normalize(cross(e,i)),o=normalize(cross(i,n));return[n[0],n[1],n[2],0,o[0],o[1],o[2],0,i[0],i[1],i[2],0,this.position[0],this.position[1],this.position[2],1]}}]),t}(),N=function(){function e(o){var r=this;a()(this,e),(o.controls=this).engine=o,this.mouseOverCanvas=!1,this._lockPointer=!0,this.pointerLocked=!1,this._rebind=!0,this._globalRebind=!1,this.keys=[],this._handlers=[],this._focusHandlers=[],this._blurHandlers=[],this._focusOnlyIfClick=!0,this.isFocused=!1,this._mouseHandlers=[null,null,null,null,null,null],this.mouse={x:0,y:0,buttons:[!1,!1,!1],movement:{x:0,y:0},sensitivity:1};for(var t=0;t<255;t++)this.keys[t]=!1,this._handlers[t]=null;window.onkeydown=function(t){return r.isFocused?(r.keys[t.keyCode]=!0,null!=r._handlers[t.keyCode]&&r._handlers[t.keyCode](t),!r._rebind):!r._globalRebind||!r._rebind},window.onkeyup=function(t){return r.keys[t.keyCode]=!1,!r._rebind},o.div.setAttribute("tabindex","0");var s=null;o.div.addEventListener("mousemove",function(t){if(r.pointerLocked)r.mouse.movement.x=-t.movementX*r.mouse.sensitivity,r.mouse.movement.y=-t.movementY*r.mouse.sensitivity,r.mouse.x=r.engine.width/2,r.mouse.y=r.engine.height/2;else{var e=o.div.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top;r.mouse.x=i,r.mouse.y=n,null==s&&(s={x:i,y:n}),r.mouse.movement.x=(i-s.x)*r.mouse.sensitivity,r.mouse.movement.y=(n-s.y)*r.mouse.sensitivity,s.x=i,s.y=n}},!1),window.addEventListener("mousemove",function(t){var e=o.div.getBoundingClientRect(),i=t.clientX,n=t.clientY;i<e.right&&i>e.left&&n<e.bottom&&n>e.top?(r.mouseOverCanvas=!0,r._focusOnlyIfClick||r.isFocused||o.div.focus()):(r.mouseOverCanvas=!1,r._focusOnlyIfClick||o.div.blur())}),o.div.onclick=function(){r._focusOnlyIfClick&&!r.isFocused&&o.div.focus(),r._lockPointer&&o.div.requestPointerLock()},o.div.onmousedown=function(t){return r.mouse.buttons[t.button]=!0,null!=r._mouseHandlers[2+t.button]&&r._mouseHandlers[2+t.button](t),!1},o.div.onmouseup=function(t){return r.mouse.buttons[t.button]=!1},o.div.oncontextmenu=function(){return!1},o.div.onblur=function(){r.isFocused=!1;for(var t=0;t<r._focusHandlers.length;t++)r._blurHandlers[t]()},o.div.onfocus=function(){r.isFocused=!0;for(var t=0;t<r._focusHandlers.length;t++)r._focusHandlers[t]()},document.addEventListener("pointerlockchange",function(){document.pointerLockElement===o.div?r.pointerLocked=!0:r.pointerLocked=!1},!1)}return c()(e,[{key:"clickForFocus",value:function(t){t=t||!this._focusOnlyIfClick,this._focusOnlyIfClick=t}},{key:"setSensitivity",value:function(t){this.mouse.sensitivity=t}},{key:"rebindDefaultBrowserActions",value:function(t){t=t||!this._rebind,this._rebind=t}},{key:"globalRebind",value:function(t){t=t||!this._globalRebind,this._globalRebind=t}},{key:"addOnFocusHandler",value:function(t){this._focusHandlers.push(t)}},{key:"addOnBlurHandler",value:function(t){this._blurHandlers.push(t)}},{key:"onKeyDown",value:function(t,e){this._handlers[t]=e}},{key:"onMouseDown",value:function(t,e){this._mouseHandlers[2+t]=e}},{key:"onMouseMove",value:function(t){this.engine.div.addEventListener("mousemove",t,!1)}},{key:"onContextMenu",value:function(t){this.engine.div.oncontextmenu=t}},{key:"lockPointer",value:function(t){t=t||!this._lockPointer,this._lockPointer=t}}]),e}(),Y=function(){function e(t){a()(this,e),(t.debugger=this).logArray=[],this.element=null}return c()(e,[{key:"setElement",value:function(t){this.element=t}},{key:"addLog",value:function(t,e,i,n,o){o=o||this.defaultOutput,this.logArray.push({name:t,object:e,value:i,view:n,output:o}),this.addView(n)}},{key:"createLogView",value:function(){return document.createElement("p")}},{key:"defaultOutput",value:function(t){return null!=object?t.name+" : "+t.object[t.value]:"log.name"}},{key:"addView",value:function(t){this.element.appendChild(t)}},{key:"updateInfo",value:function(){this.logArray.forEach(function(t){t.view.innerText=t.output(t)})}}]),e}(),z=function(){function e(t){a()(this,e),t&&t.polygons.push(this),this.webGL=t.webGL,this.texture=null,this.vertexes=[],this.position=[0,0,0],this.rotation=[0,0,0],this.rotationPoint=[0,0,0],this.parentRotation=[0,0,0],this.normals=[0,1,0,0,1,0,0,1,0],this._vertexesBuffer=null,this.UIElement=!1}return c()(e,[{key:"setTexture",value:function(t){this.texture=t}},{key:"setTextureCoords",value:function(t){this.textureCoords=t,this._coordsBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._coordsBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(this.textureCoords),this.webGL.STATIC_DRAW)}},{key:"setVertexes",value:function(t){this.vertexes=t,this._vertexesBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._vertexesBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(this.vertexes),this.webGL.STATIC_DRAW)}},{key:"setPosition",value:function(t,e,i){this.position[0]=t,this.position[1]=e,this.position[2]=i}},{key:"rotate",value:function(t,e,i){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=i}},{key:"setRotation",value:function(t,e,i){this.rotation[0]=t,this.rotation[1]=e,this.rotation[2]=i}},{key:"setRotationPoint",value:function(t,e,i){this.rotationPoint=[t,e,i]}},{key:"setParentRotation",value:function(t,e,i){this.parentRotation=[t,e,i]}},{key:"update",value:function(){}},{key:"setNormals",value:function(t){this.normals=t,this._normalBuffer=this.webGL.createBuffer(),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,this._normalBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(this.normals),this.webGL.STATIC_DRAW)}}]),e}(),H=function(){function i(t){a()(this,i),this.polygons=new Array(2),this.position=[0,0,0],this.rotationPoint=[0,0,0];var e=new z(t);e.setVertexes([0,0,0,100,100,0,0,100,0]),e.setTextureCoords([0,1,1,0,0,0]),this.polygons[0]=e,(e=new z(t)).setVertexes([100,100,0,0,0,0,100,0,0]),e.setTextureCoords([1,0,0,1,1,1]),this.polygons[1]=e,this.setNormals([0,0,1,0,0,1,0,0,1])}return c()(i,[{key:"setTexture",value:function(t){this.polygons[0].setTexture(t),this.polygons[1].setTexture(t)}},{key:"setSize",value:function(t,e){this.width=t,this.height=e,this.polygons[0].setVertexes([0,0,0,t,e,0,0,e,0]),this.polygons[1].setVertexes([t,e,0,0,0,0,t,0,0])}},{key:"setPosition",value:function(t,e,i){this.position=[t,e,i],this.polygons[0].setPosition(t,e,i),this.polygons[1].setPosition(t,e,i)}},{key:"rotate",value:function(t,e,i){var n=s(t),o=s(e),r=s(i);this.polygons[0].rotate(n,o,r),this.polygons[1].rotate(n,o,r)}},{key:"setParentRotation",value:function(t,e,i){this.polygons[0].setParentRotation(t,e,i),this.polygons[1].setParentRotation(t,e,i)}},{key:"setRotationPoint",value:function(t,e,i){this.polygons[0].setRotationPoint(t,e,i),this.polygons[1].setRotationPoint(t,e,i)}},{key:"setNormals",value:function(t){this.polygons[0].setNormals(t),this.polygons[1].setNormals(t)}},{key:"setAsUIElement",value:function(t){this.polygons[0].UIElement=t,this.polygons[1].UIElement=t}}]),i}(),X=function(){function e(t){a()(this,e),this.faces=[new H(t),new H(t),new H(t),new H(t),new H(t),new H(t)],this.position=[0,0,0],this.rotation=[0,0,0],this.faces[0].rotate(0,0,0),this.faces[0].setRotationPoint(-100,-100,100),this.faces[0].setPosition(0,0,0),this.faces[0].setNormals([0,0,1,0,0,1,0,0,1]),this.faces[1].rotate(0,90,0),this.faces[1].setRotationPoint(-100,-100,100),this.faces[1].position=[0,0,0],this.faces[1].setNormals([1,0,0,1,0,0,1,0,0]),this.faces[2].rotate(0,-180,0),this.faces[2].setRotationPoint(-100,-100,100),this.faces[2].position=[0,0,0],this.faces[2].setNormals([0,0,-1,0,0,-1,0,0,-1]),this.faces[3].rotate(0,270,0),this.faces[3].setRotationPoint(-100,-100,100),this.faces[3].position=[0,0,0],this.faces[3].setNormals([-1,0,0,-1,0,0,-1,0,0]),this.faces[4].rotate(-90,0,0),this.faces[4].setRotationPoint(-100,-100,100),this.faces[4].position=[0,0,0],this.faces[4].setNormals([0,1,0,0,1,0,0,1,0]),this.faces[5].rotate(90,0,0),this.faces[5].setRotationPoint(-100,-100,100),this.faces[5].position=[0,0,0],this.faces[5].setNormals([0,-1,0,0,-1,0,0,-1,0])}return c()(e,[{key:"_updateFaces",value:function(){this.faces[0].setPosition(this.position[0],this.position[1],this.position[2])}},{key:"setTexture",value:function(t,e,i,n,o,r){this.faces[0].setTexture(t),this.faces[1].setTexture(e),this.faces[2].setTexture(i),this.faces[3].setTexture(n),this.faces[4].setTexture(o),this.faces[5].setTexture(r)}},{key:"setSize",value:function(e,i,n){this.width=e,this.height=i,this.depth=n,this.faces.forEach(function(t){t.setSize(e,i),t.setRotationPoint(-e/2,-i/2,n/2)})}},{key:"setPosition",value:function(t,e,i){this.position=[t,e,i],this.faces[0].setPosition(t,e,i),this.faces[1].setPosition(t,e,i),this.faces[2].setPosition(t,e,i),this.faces[3].setPosition(t,e,i),this.faces[4].setPosition(t,e,i),this.faces[5].setPosition(t,e,i)}},{key:"rotate",value:function(t,e,i){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=i;var n=s(this.rotation[0]),o=s(this.rotation[1]),r=s(this.rotation[2]);this.faces.forEach(function(t){t.setParentRotation(n,o,r)})}},{key:"setRotation",value:function(t,e,i){var n=s(t),o=s(e),r=s(i);this.faces.forEach(function(t){t.setParentRotation(n,o,r)})}},{key:"animation",value:function(){this.rotate(1,1,1)}},{key:"animate",value:function(t,e){e=e||this.animation,this._animationInterval=setInterval(e,1e3/t)}},{key:"removeAnimation",value:function(){clearInterval(this._animationInterval)}},{key:"setAsUIElement",value:function(t){this.faces[0].setAsUIElement(t),this.faces[1].setAsUIElement(t),this.faces[2].setAsUIElement(t),this.faces[3].setAsUIElement(t),this.faces[4].setAsUIElement(t),this.faces[5].setAsUIElement(t)}}]),e}(),V=function(){function e(t){a()(this,e),this.canvas=document.createElement("canvas"),this.canvas.width=t.div.width,this.canvas.height=t.div.height,this.canvas.style="position: absolute; height: 100%; width: 100%; z-index: 999999; left: 0; right: 0; top: 0;",this.div=document.createElement("div"),this.div.style="position: absolute; height: 100%; width: 100%; z-index: 999999; left: 0; right: 0; top: 0;",t.div.appendChild(this.canvas),t.div.appendChild(this.div),this.context=this.canvas.getContext("2d"),this.elements=[],t.ui=this}return c()(e,[{key:"addElement",value:function(t){this.elements.push(t)}},{key:"removeElement",value:function(t){var e=this.elements.indexOf(t);this.elements.removeAt(e)}},{key:"_draw",value:function(){this.elements.forEach(function(t){t.draw()})}}]),e}();i.d(e,"radToDeg",function(){return n}),i.d(e,"degToRad",function(){return s}),i.d(e,"isPowerOf2",function(){return o}),i.d(e,"Matrix",function(){return h}),i.d(e,"unit",function(){return l}),i.d(e,"translation",function(){return f}),i.d(e,"rotationX",function(){return y}),i.d(e,"rotationY",function(){return w}),i.d(e,"rotationZ",function(){return x}),i.d(e,"scaling",function(){return m}),i.d(e,"multiply",function(){return g}),i.d(e,"vec3Multiply",function(){return v}),i.d(e,"transformVector",function(){return L}),i.d(e,"inverse",function(){return _}),i.d(e,"normalize",function(){return d}),i.d(e,"Engine",function(){return I}),i.d(e,"Camera",function(){return D}),i.d(e,"Controls",function(){return N}),i.d(e,"Debugger",function(){return Y}),i.d(e,"Texture",function(){return C}),i.d(e,"Rect",function(){return H}),i.d(e,"Cube",function(){return X}),i.d(e,"Object",function(){return j}),i.d(e,"Map",function(){return S}),i.d(e,"UI",function(){return V})}])});