<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: materials/Glass.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: materials/Glass.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Material } from "./Material";
import * as Vectors from "../math/Vectors.js"

/**
 * Base class for materials which will attached to objects. 
 * @param {Engine} engine
 * @param {Object} [object]
 */
export class Glass extends Material {
    constructor (engine, object) {
        super(engine, object)
        this.shaderProgram = engine.shaders.reflection
    }

    /**
     * Adds shader for material.
     * @param {ShaderProgram} shader 
     */
    setShaderProgram (shaderProgram) {
        this.shaderProgram = shaderProgram
    }

    /**
     * Draws cube using this material.
     * @param {Object} object 
     */
    drawCube (object) {
        if (object.texture.loaded) {
            this.shaderProgram.use()
            this.webGL.uniformMatrix4fv(this.shaderProgram.cameraLocation, false, this.engine.camera.matrix)
            this.webGL.uniform3fv(this.shaderProgram.lightPositionsLocation, this.engine.lightsPositions)
            this.webGL.uniform1fv(this.shaderProgram.lightRangesLocation, this.engine.lightsRanges)
            this.webGL.uniform1i(this.shaderProgram.lightsCountLocation, this.engine.lights.length)
            this.webGL.uniform1f(this.shaderProgram.lightMinValueLocation, this.engine.globalLightMinValue)
            this.engine.webGL.uniformMatrix4fv(this.shaderProgram.worldMatrixLocation, false, object._world)


            this.engine.webGL.enableVertexAttribArray(this.shaderProgram.positionLocation)
            this.engine.webGL.bindBuffer(this.engine.webGL.ARRAY_BUFFER, object.vertexesBuffer)
            this.engine.webGL.vertexAttribPointer(
                this.shaderProgram.positionLocation, 3, this.engine.webGL.FLOAT, false, 0, 0
            )

            this.engine.webGL.enableVertexAttribArray(this.shaderProgram.normalLocation);
            this.engine.webGL.bindBuffer(this.engine.webGL.ARRAY_BUFFER, object.normalBuffer);
            this.engine.webGL.vertexAttribPointer(
                this.shaderProgram.normalLocation, 3, this.engine.webGL.FLOAT, false, 0, 0)

            this.engine.webGL.uniform1i(this.shaderProgram.textureLocation, object.texture._textureBlockLocation)
            this.engine.webGL.uniformMatrix4fv(this.shaderProgram.matrixLocation, false, object._matrix)
            this.engine.webGL.uniformMatrix4fv(this.shaderProgram.rotationMatrixLocation, false, object._rotationMatrix)
            this.engine.webGL.uniform3fv(this.shaderProgram.worldCameraPositionLocation, new Float32Array(this.engine.camera.position))

            this.engine.webGL.drawArrays(this.engine.webGL.TRIANGLES, 0, object.vertexes.length / 3)
            this.engine.drawCallsPerFrame++
            this.engine.drawCalls++
            }
    }

    /**
     * Draws object using this material.
     * @param {Object} object 
     */
    drawObject(object) {
        if (object.texture.loaded) {
            this.shaderProgram.use()
            this.webGL.uniform3fv(this.shaderProgram.lightPositionsLocation, this.engine.lightsPositions)
            this.webGL.uniform1fv(this.shaderProgram.lightRangesLocation, this.engine.lightsRanges)
            this.webGL.uniform1i(this.shaderProgram.lightsCountLocation, this.engine.lights.length)
            this.webGL.uniform1f(this.shaderProgram.lightMinValueLocation, this.engine.globalLightMinValue)

            this.engine.webGL.uniform1i(this.shaderProgram.textureLocation, object.texture._textureBlockLocation)
            this.engine.webGL.uniformMatrix4fv(this.shaderProgram.matrixLocation, false, object._matrix)
            this.engine.webGL.uniformMatrix4fv(this.shaderProgram.rotationMatrixLocation, false, object._rotationMatrix)
            this.engine.webGL.uniform3fv(this.shaderProgram.worldCameraPositionLocation, new Float32Array(this.engine.camera.position))
            this.engine.webGL.uniformMatrix4fv(this.shaderProgram.worldMatrixLocation, false, object._world)

            if (!object.behindTheCamera) {
                object.faces.forEach(face => {
                    this.engine.webGL.enableVertexAttribArray(this.shaderProgram.positionLocation)
                    this.engine.webGL.bindBuffer(this.engine.webGL.ARRAY_BUFFER, face.vertexesBuffer)
                    this.engine.webGL.vertexAttribPointer(
                        this.shaderProgram.positionLocation, 3, this.engine.webGL.FLOAT, false, 0, 0
                    )

                    this.engine.webGL.enableVertexAttribArray(this.shaderProgram.normalLocation);
                    this.engine.webGL.bindBuffer(this.engine.webGL.ARRAY_BUFFER, face.normalBuffer);
                    this.engine.webGL.vertexAttribPointer(
                        this.shaderProgram.normalLocation, 3, this.engine.webGL.FLOAT, false, 0, 0)

                    this.engine.webGL.drawArrays(this.engine.webGL.TRIANGLES, 0, face.vertexes.length / 3)
                    this.engine.drawCallsPerFrame++
                    this.engine.drawCalls++
                })
            }
        }
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Math.html">Math</a></li><li><a href="module-Matrixes.html">Matrixes</a></li><li><a href="module-Vectors.html">Vectors</a></li></ul><h3>Classes</h3><ul><li><a href="Camera.html">Camera</a></li><li><a href="Controls.html">Controls</a></li><li><a href="Cube.html">Cube</a></li><li><a href="CubeD.html">CubeD</a></li><li><a href="CubeTexture.html">CubeTexture</a></li><li><a href="Debugger.html">Debugger</a></li><li><a href="Engine.html">Engine</a></li><li><a href="Glass.html">Glass</a></li><li><a href="Grid.html">Grid</a></li><li><a href="Material.html">Material</a></li><li><a href="module-Matrixes.Matrix.html">Matrix</a></li><li><a href="Object.html">Object</a></li><li><a href="Picture.html">Picture</a></li><li><a href="Polygon.html">Polygon</a></li><li><a href="Rect.html">Rect</a></li><li><a href="ReflectionTexture.html">ReflectionTexture</a></li><li><a href="SimpleTexture.html">SimpleTexture</a></li><li><a href="Sound_Sound.html">Sound</a></li><li><a href="UI.html">UI</a></li></ul><h3>Global</h3><ul><li><a href="global.html#compileShader">compileShader</a></li><li><a href="global.html#createWebGLProgram">createWebGLProgram</a></li><li><a href="global.html#getWebGL">getWebGL</a></li><li><a href="global.html#getWebGLById">getWebGLById</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue May 07 2019 02:37:28 GMT+0300 (Eastern European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
